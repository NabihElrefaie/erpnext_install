ERPNext Multi-Version Installation Manager
A comprehensive bash script for installing multiple ERPNext versions on a single server. Supports installations for different users and multiple ERPNext versions (v13, v14, v15, v16, develop) within the same user account.

ğŸ“‹ Table of Contents
Features

Prerequisites

Quick Start

Installation Modes

Detailed Installation Guide

Managing Installations

Troubleshooting

Advanced Usage

Uninstallation

FAQ

âœ¨ Features
Multiple Version Support: Install ERPNext v13, v14, v15, v16, and develop branch

Multi-User Support: Install for different Linux users or use same user

Conflict-Free: Automatic port assignment prevents conflicts

Flexible Installation Modes:

Single installation

Multiple versions in same user

Different users installation

Production Ready: Includes SSL, supervisor, and production setup

Additional Apps: Install extra Frappe apps from awesome-frappe repository

Compatibility Checks: OS and Python version validation

ğŸš€ Prerequisites
Supported Operating Systems
Ubuntu: 20.04, 22.04, 23.04, 24.04

Debian: 9, 10, 11, 12

Hardware Requirements
Minimum: 4GB RAM, 2 CPU cores, 40GB storage

Recommended: 8GB RAM, 4 CPU cores, 80GB storage

For production: 16GB RAM, 8 CPU cores, 200GB SSD

Network Requirements
Open ports: 80, 443, 22 (or custom ports for multiple installations)

Domain name (for SSL setup)

Static IP recommended

ğŸ“¥ Quick Start
Download the script:

bash
wget https://raw.githubusercontent.com/your-repo/erpnext-installer.sh -O erpnext-installer.sh
chmod +x erpnext-installer.sh
Run the installer:

bash
sudo ./erpnext-installer.sh
Follow the interactive prompts

ğŸ”§ Installation Modes
Mode 1: Single Installation (Default)
Install a single ERPNext version for a specific user.

Mode 2: Multiple Versions for Same User
Install ERPNext v15 and v16 (or other combinations) in different bench directories under the same user.

Mode 3: Different Users Installation
Install different ERPNext versions for different Linux users.

ğŸ“– Detailed Installation Guide
Step 1: System Preparation
Update System Packages
bash
sudo apt update && sudo apt upgrade -y
sudo apt install curl wget git -y
Verify OS Compatibility
bash
lsb_release -a
# Should show Ubuntu 20.04+ or Debian 9+
Step 2: Run the Installer
bash
sudo ./erpnext-installer.sh
Step 3: Select Installation Mode
Option 1: Single Installation
text
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘        Multi-User ERPNext Installation Manager          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Choose installation mode:
1. Install new ERPNext version
2. Manage existing installations
3. Install multiple versions for same user
Enter choice (1-3): 1
Option 2: Multiple Versions in Same User
text
Enter choice (1-3): 3

Install multiple ERPNext versions for same user
Select installation user:
1. Use current user (ubuntu)
2. Create new user
3. Select existing user
Enter choice (1-3): 1
Step 4: Select ERPNext Version
text
Select ERPNext version:
1) Version 13
2) Version 14
3) Version 15
4) Version 16
5) Develop
#? 3
Step 5: Configure Installation
For Single Installation:
text
Enter bench name (default: frappe-bench): erpnext-15
Enter site name: erp15.example.com
Enter MariaDB root password: ******
Confirm password: ******
Enter Administrator password: ******
Confirm password: ******
Install ERPNext? (yes/no): yes
Setup production? (yes/no): yes
For Multiple Versions:
text
Add version to install:
1. Version 13
2. Version 14
3. Version 15
4. Version 16
5. Develop
6. Done adding versions
Enter choice (1-6): 3

Enter bench name for Version 15 (default: frappe-bench-15): erpnext-15

Add version to install:
... (add another version)
Enter choice (1-6): 4

Enter bench name for Version 16 (default: frappe-bench-16): erpnext-16

Enter choice (1-6): 6
Step 6: Additional Configuration
SSL Setup (Optional but Recommended)
text
Would you like to install SSL? (yes/no): yes
Make sure your domain name is pointed to the IP of this instance
Enter your email address: admin@example.com
Additional Apps Installation
text
Would you like to install additional Frappe apps? (yes/no): yes
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘        Additional Apps Installation                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Note: App compatibility may vary...
Choose apps to install (Space=toggle, Enter=confirm):
[ ] Frappe CRM
[ ] Frappe HRMS
[ ] Frappe Helpdesk
[*] Frappe LMS
...
ğŸ› ï¸ Managing Installations
Start/Stop Benches
Start a specific bench:
bash
cd ~/erpnext-15
bench start
Stop a bench:
bash
cd ~/erpnext-15
bench stop
Check Installation Status
List all benches for current user:
bash
ls -la ~/ | grep bench
Check running services:
bash
sudo supervisorctl status
Access ERPNext Instances
Development Mode:
v15: http://your-server-ip:18001

v16: http://your-server-ip:18002

Production Mode:
v15: https://erp15.example.com

v16: https://erp16.example.com

Common Commands
Update a bench:
bash
cd ~/erpnext-15
bench update
Backup a site:
bash
cd ~/erpnext-15
bench --site erp15.example.com backup
Restore a backup:
bash
cd ~/erpnext-15
bench --site erp15.example.com restore path/to/backup.sql.gz
Check bench health:
bash
cd ~/erpnext-15
bench doctor
ğŸ”§ Port Configuration
Each installation gets unique ports:

Service	Base Port	Example v15	Example v16
MariaDB	13306+	13307	13308
Redis Queue	15000+	15001	15002
Redis Cache	16000+	16001	16002
Redis SocketIO	17000+	17001	17002
Bench	18000+	18001	18002
View Port Assignments:
bash
# Check ports for a specific bench
cat ~/erpnext-15/sites/common_site_config.json | grep port
ğŸš¨ Troubleshooting
Common Issues and Solutions
1. Port Conflicts
Symptoms: Installation fails with "port already in use" errors

Solution:

bash
# Check which ports are in use
sudo netstat -tulpn | grep LISTEN

# Kill conflicting processes or use different ports
sudo kill -9 <PID>
2. MariaDB Connection Issues
Solution:

bash
# Check MariaDB status
sudo systemctl status mariadb

# Restart MariaDB
sudo systemctl restart mariadb

# Check port configuration
sudo grep -r "port" /etc/mysql/
3. Python Version Issues
Solution:

bash
# Check Python versions
python3 --version
python3.10 --version

# Install missing Python version
sudo apt install python3.10 python3.10-venv
4. Redis Issues
Solution:

bash
# Check Redis instances
ps aux | grep redis

# Restart Redis
sudo systemctl restart redis-server
sudo supervisorctl restart redis-*
5. Supervisor Issues
Solution:

bash
# Check supervisor logs
sudo tail -f /var/log/supervisor/supervisord.log

# Reload supervisor
sudo supervisorctl reread
sudo supervisorctl update
sudo supervisorctl restart all
Log Files Location
Service	Log Location
Bench	~/bench-name/logs/
Supervisor	/var/log/supervisor/
Nginx	/var/log/nginx/
MariaDB	/var/log/mysql/
Redis	/var/log/redis/
ğŸš€ Advanced Usage
Custom Port Configuration
To manually set ports for an installation:

Before installation, set environment variables:

bash
export MYSQL_PORT=13307
export REDIS_QUEUE_PORT=15001
export REDIS_CACHE_PORT=16001
export REDIS_SOCKETIO_PORT=17001
export BENCH_PORT=18001
Run installation with custom ports:

bash
./erpnext-installer.sh
Install Specific Branch
To install a specific branch or commit:

After bench creation, manually get apps:

bash
cd ~/erpnext-15
bench get-app erpnext https://github.com/frappe/erpnext.git --branch version-15-hotfix
Custom Bench Configuration
Edit bench configuration:

bash
cd ~/erpnext-15
nano sites/common_site_config.json
Example configuration:

json
{
    "db_host": "localhost",
    "db_port": 13307,
    "redis_cache": "redis://localhost:16001",
    "redis_queue": "redis://localhost:15001",
    "redis_socketio": "redis://localhost:17001",
    "socketio_port": 18001,
    "developer_mode": 1,
    "maintenance_mode": 0,
    "serve_default_site": 1
}
ğŸ—‘ï¸ Uninstallation
Remove a Single Bench
Stop the bench:

bash
cd ~/erpnext-15
bench stop
sudo supervisorctl stop all
Remove bench directory:

bash
sudo rm -rf ~/erpnext-15
Remove database:

bash
sudo mysql -u root -p -e "DROP DATABASE IF EXISTS erp15_example_com;"
Remove supervisor config:

bash
sudo rm /etc/supervisor/conf.d/erpnext-15-*.conf
sudo supervisorctl update
Complete Uninstallation
Remove all benches:

bash
sudo rm -rf ~/*-bench*
sudo rm -rf /home/*/*-bench*
Remove services:

bash
sudo apt remove mariadb-server redis-server nginx supervisor -y
sudo apt autoremove -y
Clean up users (if created):

bash
sudo deluser erpnext-user
sudo rm -rf /home/erpnext-user
â“ FAQ
Q1: Can I run multiple ERPNext versions simultaneously?
A: Yes! Each installation uses different ports, so you can run v15 on port 18001 and v16 on port 18002 simultaneously.

Q2: How much disk space do I need for multiple installations?
A: Each ERPNext installation takes about 2-5GB. For v15 + v16, plan for 10-15GB minimum.

Q3: Can I share databases between versions?
A: No, each version requires its own database due to schema differences.

Q4: How do I migrate from single to multiple installations?
A:

Backup your current installation

Install new version using this script

Migrate data using bench backup/restore

Run both versions side by side during transition

Q5: Can I install on cloud servers (AWS, DigitalOcean, etc.)?
A: Yes! The script works on any Ubuntu/Debian cloud server. Ensure:

Open necessary ports in firewall

Sufficient RAM and CPU

Domain names configured for SSL

Q6: How to update multiple installations?
A: Update each bench separately:

bash
cd ~/erpnext-15 && bench update
cd ~/erpnext-16 && bench update
Q7: Can I use different domains for each installation?
A: Yes! During installation, specify different site names (FQDNs). For SSL, ensure each domain points to your server IP.

Q8: How to monitor resource usage?
A: Use system monitoring tools:

bash
# CPU/Memory
htop

# Disk usage
df -h
du -sh ~/*-bench*

# Network
iftop
ğŸ“Š Performance Tuning
For Multiple Installations:
Adjust Redis memory limits:

bash
sudo nano /etc/redis/redis.conf
# Set: maxmemory 512mb
# Set: maxmemory-policy allkeys-lru
Optimize MariaDB:

bash
sudo nano /etc/mysql/my.cnf
# Add:
[mysqld]
innodb_buffer_pool_size = 256M
query_cache_size = 32M
Configure system limits:

bash
# Increase file limits
sudo nano /etc/security/limits.conf
# Add:
* soft nofile 65536
* hard nofile 65536
ğŸ”„ Updates and Maintenance
Update the Installer Script
bash
wget -O erpnext-installer.sh https://raw.githubusercontent.com/your-repo/erpnext-installer.sh
chmod +x erpnext-installer.sh
Regular Maintenance Tasks
Weekly:

bash
# Update system
sudo apt update && sudo apt upgrade -y

# Update benches
cd ~/erpnext-15 && bench update
cd ~/erpnext-16 && bench update

# Clean up logs
sudo find /var/log -name "*.log" -type f -mtime +7 -delete
Monthly:

bash
# Backup all sites
cd ~/erpnext-15 && bench backup-all-sites
cd ~/erpnext-16 && bench backup-all-sites

# Check disk space
df -h
ğŸ“ Support
Getting Help
Check logs first for error messages

Search issues on GitHub

Community forums:

Frappe Forum

ERPNext Forum

Reporting Issues
When reporting issues, include:

OS version: lsb_release -a

Script version: ./erpnext-installer.sh --version

Error logs from relevant log files

Steps to reproduce

ğŸ“ License
This script is provided under MIT License. Use at your own risk.

ğŸ™ Acknowledgments
Frappe Technologies for ERPNext

Awesome-Frappe community for additional apps

Contributors and testers